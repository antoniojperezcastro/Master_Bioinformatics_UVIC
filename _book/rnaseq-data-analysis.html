<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>6 RNAseq data analysis | Master in Bioinformatics and Omic Data Analysis</title>
  <meta name="description" content="6 RNAseq data analysis | Master in Bioinformatics and Omic Data Analysis" />
  <meta name="generator" content="bookdown 0.20 and GitBook 2.6.7" />

  <meta property="og:title" content="6 RNAseq data analysis | Master in Bioinformatics and Omic Data Analysis" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="6 RNAseq data analysis | Master in Bioinformatics and Omic Data Analysis" />
  
  
  

<meta name="author" content="Juan R González" />


<meta name="date" content="2021-01-18" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="microarray-data-analysis.html"/>
<link rel="next" href="references.html"/>
<script src="libs/header-attrs-2.3/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Bioinformatics</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a></li>
<li class="chapter" data-level="2" data-path="bioconductor.html"><a href="bioconductor.html"><i class="fa fa-check"></i><b>2</b> Bioconductor</a>
<ul>
<li class="chapter" data-level="2.1" data-path="bioconductor.html"><a href="bioconductor.html#bioconductors-overview"><i class="fa fa-check"></i><b>2.1</b> Bioconductor’s overview</a></li>
<li class="chapter" data-level="2.2" data-path="bioconductor.html"><a href="bioconductor.html#bioconductor-infrastructures"><i class="fa fa-check"></i><b>2.2</b> Bioconductor infrastructures</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="bioconductor.html"><a href="bioconductor.html#snpmatrix"><i class="fa fa-check"></i><b>2.2.1</b> <code>snpMatrix</code></a></li>
<li class="chapter" data-level="2.2.2" data-path="bioconductor.html"><a href="bioconductor.html#expressionset"><i class="fa fa-check"></i><b>2.2.2</b> <code>ExpressionSet</code></a></li>
<li class="chapter" data-level="2.2.3" data-path="bioconductor.html"><a href="bioconductor.html#summarizedexperiment"><i class="fa fa-check"></i><b>2.2.3</b> <code>SummarizedExperiment</code></a></li>
<li class="chapter" data-level="2.2.4" data-path="bioconductor.html"><a href="bioconductor.html#genomic-ranges-granges"><i class="fa fa-check"></i><b>2.2.4</b> <code>Genomic Ranges (GRanges)</code></a></li>
<li class="chapter" data-level="2.2.5" data-path="bioconductor.html"><a href="bioconductor.html#rangedsummarizedexperiment"><i class="fa fa-check"></i><b>2.2.5</b> <code>RangedSummarizedExperiment</code></a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="bioconductor.html"><a href="bioconductor.html#annotation"><i class="fa fa-check"></i><b>2.3</b> Annotation</a></li>
<li class="chapter" data-level="2.4" data-path="bioconductor.html"><a href="bioconductor.html#annotate-package"><i class="fa fa-check"></i><b>2.4</b> <code>annotate</code> package</a></li>
<li class="chapter" data-level="2.5" data-path="bioconductor.html"><a href="bioconductor.html#biomart"><i class="fa fa-check"></i><b>2.5</b> BioMart</a></li>
<li class="chapter" data-level="2.6" data-path="bioconductor.html"><a href="bioconductor.html#annotate-snps"><i class="fa fa-check"></i><b>2.6</b> Annotate SNPs</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="single-association-analysis.html"><a href="single-association-analysis.html"><i class="fa fa-check"></i><b>3</b> Single association analysis</a>
<ul>
<li class="chapter" data-level="3.1" data-path="single-association-analysis.html"><a href="single-association-analysis.html#descriptive-analysis"><i class="fa fa-check"></i><b>3.1</b> Descriptive analysis</a></li>
<li class="chapter" data-level="3.2" data-path="single-association-analysis.html"><a href="single-association-analysis.html#hardy-weinberg-equilibrium"><i class="fa fa-check"></i><b>3.2</b> Hardy-Weinberg equilibrium</a></li>
<li class="chapter" data-level="3.3" data-path="single-association-analysis.html"><a href="single-association-analysis.html#single-snp-association-analysis"><i class="fa fa-check"></i><b>3.3</b> Single SNP association analysis</a></li>
<li class="chapter" data-level="3.4" data-path="single-association-analysis.html"><a href="single-association-analysis.html#gene-environment-and-gene-gene-interactions"><i class="fa fa-check"></i><b>3.4</b> Gene-environment and gene-gene interactions</a></li>
<li class="chapter" data-level="3.5" data-path="single-association-analysis.html"><a href="single-association-analysis.html#haplotype-analysis"><i class="fa fa-check"></i><b>3.5</b> Haplotype analysis</a>
<ul>
<li class="chapter" data-level="3.5.1" data-path="single-association-analysis.html"><a href="single-association-analysis.html#haplotype-estimation"><i class="fa fa-check"></i><b>3.5.1</b> Haplotype estimation</a></li>
<li class="chapter" data-level="3.5.2" data-path="single-association-analysis.html"><a href="single-association-analysis.html#haplotype-association"><i class="fa fa-check"></i><b>3.5.2</b> Haplotype association</a></li>
<li class="chapter" data-level="3.5.3" data-path="single-association-analysis.html"><a href="single-association-analysis.html#sliding-window-approach"><i class="fa fa-check"></i><b>3.5.3</b> Sliding window approach</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="single-association-analysis.html"><a href="single-association-analysis.html#genetic-score"><i class="fa fa-check"></i><b>3.6</b> Genetic score</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="genome-wide-association-studies.html"><a href="genome-wide-association-studies.html"><i class="fa fa-check"></i><b>4</b> Genome-wide association studies</a>
<ul>
<li class="chapter" data-level="4.1" data-path="genome-wide-association-studies.html"><a href="genome-wide-association-studies.html#quality-control-of-snps"><i class="fa fa-check"></i><b>4.1</b> Quality control of SNPs</a></li>
<li class="chapter" data-level="4.2" data-path="genome-wide-association-studies.html"><a href="genome-wide-association-studies.html#quality-control-of-individuals"><i class="fa fa-check"></i><b>4.2</b> Quality control of individuals</a></li>
<li class="chapter" data-level="4.3" data-path="genome-wide-association-studies.html"><a href="genome-wide-association-studies.html#population-ancestry"><i class="fa fa-check"></i><b>4.3</b> Population ancestry</a></li>
<li class="chapter" data-level="4.4" data-path="genome-wide-association-studies.html"><a href="genome-wide-association-studies.html#genome-wide-association-analysis"><i class="fa fa-check"></i><b>4.4</b> Genome-wide association analysis</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="microarray-data-analysis.html"><a href="microarray-data-analysis.html"><i class="fa fa-check"></i><b>5</b> Microarray data analysis</a></li>
<li class="chapter" data-level="6" data-path="rnaseq-data-analysis.html"><a href="rnaseq-data-analysis.html"><i class="fa fa-check"></i><b>6</b> RNAseq data analysis</a>
<ul>
<li class="chapter" data-level="6.1" data-path="index.html"><a href="index.html#introduction"><i class="fa fa-check"></i><b>6.1</b> Introduction</a></li>
<li class="chapter" data-level="6.2" data-path="rnaseq-data-analysis.html"><a href="rnaseq-data-analysis.html#within-sample-normalization-of-read-counts"><i class="fa fa-check"></i><b>6.2</b> Within sample normalization of read counts</a></li>
<li class="chapter" data-level="6.3" data-path="rnaseq-data-analysis.html"><a href="rnaseq-data-analysis.html#exploratory-analysis-of-the-read-counts-table"><i class="fa fa-check"></i><b>6.3</b> Exploratory analysis of the read counts table</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="rnaseq-data-analysis.html"><a href="rnaseq-data-analysis.html#clustering"><i class="fa fa-check"></i><b>6.3.1</b> Clustering</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i><b>7</b> References</a>
<ul>
<li class="chapter" data-level="7.1" data-path="references.html"><a href="references.html#BioCEx"><i class="fa fa-check"></i><b>7.1</b> Bioconductor</a></li>
<li class="chapter" data-level="7.2" data-path="references.html"><a href="references.html#genetic-association-studies"><i class="fa fa-check"></i><b>7.2</b> Genetic association studies</a></li>
<li class="chapter" data-level="7.3" data-path="references.html"><a href="references.html#gwas"><i class="fa fa-check"></i><b>7.3</b> GWAS</a></li>
<li class="chapter" data-level="7.4" data-path="microarray-data-analysis.html"><a href="microarray-data-analysis.html#microarray-data-analysis"><i class="fa fa-check"></i><b>7.4</b> Microarray data analysis</a></li>
<li class="chapter" data-level="7.5" data-path="rnaseq-data-analysis.html"><a href="rnaseq-data-analysis.html#rnaseq-data-analysis"><i class="fa fa-check"></i><b>7.5</b> RNAseq data analysis</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Master in Bioinformatics and Omic Data Analysis</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="rnaseq-data-analysis" class="section level1" number="6">
<h1><span class="header-section-number">6</span> RNAseq data analysis</h1>
<p>In this chapter we will assume that the data analyst has obtained a read count table from raw fastq reads obtained from an Illumina sequencing run. This can also be performed using Bioconductor R packages, but sometimes you can ask the core facility for this data since it can be very computational expensive. Here we demonstrate how to process the count table, make a case-control differential expression analysis, and do some downstream functional enrichment analysis that can also be applied to the results obtained from microarrays experiments.</p>
<div id="introduction" class="section level2" number="6.1">
<h2><span class="header-section-number">6.1</span> Introduction</h2>
<p>The transcription profile of a particular gene follows from counting the number of times the transcripts of the genes were mapped by sequenced reads. The summarized RNA-seq data is known as count data. Figure <a href="rnaseq-data-analysis.html#fig:RNAseq">6.1</a> describes the main steps that are taken to obtain the count table that measures the transcription of active genes in biological samples.</p>
<div class="figure" style="text-align: center"><span id="fig:RNAseq"></span>
<img src="figures/counts_scheme_3.png" alt="RNA-seq scheme to get count data." width="120%" />
<p class="caption">
Figure 6.1: RNA-seq scheme to get count data.
</p>
</div>
<p>The sequenced reads can be counted in a number of different ways:</p>
<ul>
<li>By alignment to the genome and summarized at either gene or transcript (isoform) level.</li>
<li>By alignment to the transcriptome and summarized at either gene or transcript (isoform) level.</li>
<li>By assembling directly into transcripts and summarized at either gene or transcript (isoform) level.</li>
</ul>
<p>Table <a href="rnaseq-data-analysis.html#fig:counts">6.2</a> shows a hypothetical RNA-seq data of <span class="math inline">\(G\)</span> genes obtained for 6 samples, belonging to two different conditions. The main goal is to discover the genes that are differentially expressed between individuals from condition A and B.</p>
<div class="figure" style="text-align: center"><span id="fig:counts"></span>
<img src="figures/example_table.png" alt="Table of counts for an hypotethical data example." width="70%" />
<p class="caption">
Figure 6.2: Table of counts for an hypotethical data example.
</p>
</div>
<p>In RNA-seq analysis, we deal with the number of reads (<strong>counts</strong>) that map to the biological feature of interest (gene, transcript, exon, etc.). The count number depends linearly with the abundance of the target’s transcription because the sequencing of RNA is a direct measure of transcription. This is considered as one of the advantages over microarrays that indirectly measure transcription by hybridization. Figure <a href="rnaseq-data-analysis.html#fig:microVSrnaseq">6.3</a> illustrates the type of data from microarray and RNA-seq experiments. While microarray data is continuous, RNA-seq is discrete and, therefore, the modeling of each type of data is different.</p>
<div class="figure" style="text-align: center"><span id="fig:microVSrnaseq"></span>
<img src="_main_files/figure-html/microVSrnaseq-1.png" alt="Gene expression distribution obtained from RNA-seq and microarray data from a hypothetical gene." width="672" />
<p class="caption">
Figure 6.3: Gene expression distribution obtained from RNA-seq and microarray data from a hypothetical gene.
</p>
</div>
<p>There are two important factors that influence the number of gene counts and which need to be taken into account, see figure <a href="rnaseq-data-analysis.html#fig:rnaseqParts">6.4</a>. The first factor is the <strong>sequencing depth</strong> or <strong>library size</strong>, that is, the total number of reads mapped to the genome; the second factor is the <strong>gene length</strong>, i.e. the number of bases covering a gene. It is expected that larger genes, for a given level of transcription, will have more gene counts.</p>
<div class="figure" style="text-align: center"><span id="fig:rnaseqParts"></span>
<img src="figures/rnaseq_parts.png" alt="Key concepts involved in an RNA-seq experiment." width="100%" />
<p class="caption">
Figure 6.4: Key concepts involved in an RNA-seq experiment.
</p>
</div>
</div>
<div id="within-sample-normalization-of-read-counts" class="section level2" number="6.2">
<h2><span class="header-section-number">6.2</span> Within sample normalization of read counts</h2>
<p>The most common application after a gene’s expression is quantified (as the number of reads aligned to the gene), is to compare the gene’s expression in different conditions, for instance, in a case-control setting (e.g. disease versus normal) or in a time-series (e.g. along different developmental stages). Making such comparisons helps identify the genes that might be responsible for a disease or an impaired developmental trajectory. However, there are multiple caveats that needs to be addressed before making a comparison between the read counts of a gene in different conditions (<a href="https://www.tandfonline.com/doi/full/10.4161/cib.25849">Maza, et al. 2013</a>).</p>
<p>Library size (i.e. sequencing depth) varies between samples coming from different lanes of the flow cell of the sequencing machine.
Longer genes will have a higher number of reads.
Library composition (i.e. relative size of the studied transcriptome) can be different in two different biological conditions.
GC content biases across different samples may lead to a biased sampling of genes.</p>
<p>The most basic normalization approaches address the sequencing depth bias. Such procedures normalize the read counts per gene by dividing each gene’s read count by a certain value and multiplying it by <span class="math inline">\(10^6\)</span>. These normalized values are usually referred to as CPM (counts per million reads):</p>
<ul>
<li>Total Counts Normalization (divide counts by the <strong>sum</strong> of all counts)</li>
<li>Upper Quartile Normalization (divide counts by the <strong>upper quartile</strong> value of the counts)</li>
<li>Median Normalization (divide counts by the <strong>median</strong> of all counts)</li>
</ul>
<p>Popular metrics that improve upon CPM are RPKM/FPKM (reads/fragments per kilobase of million reads) and TPM (transcripts per million). RPKM is obtained by dividing the CPM value by another factor, which is the length of the gene per kilobase. FPKM is the same as RPKM, but is used for paired-end reads. Thus, RPKM/FPKM methods account for, firstly, the <strong>library size</strong>, and secondly, the <strong>gene lengths</strong>.</p>
<p>TPM also controls for both the library size and the gene lengths, however, with the TPM method, the read counts are first normalized by the gene length (per kilobase), and then gene-length normalized values are divided by the sum of the gene-length normalized values and multiplied by <span class="math inline">\(10^6\)</span>. Thus, the sum of normalized values for TPM will always be equal to <span class="math inline">\(10^6\)</span> for each library, while the sum of RPKM/FPKM values do not sum to <span class="math inline">\(10^6\)</span>. Therefore, it is easier to interpret TPM values than RPKM/FPKM values.</p>
<p>Other methods that consider <strong>GC content</strong> are: cqn (<a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC3297825/">Hansen and Irizarry, 2012</a>), EDAseq (<a href="https://bmcbioinformatics.biomedcentral.com/articles/10.1186/1471-2105-12-480">Risso, et al. 2011</a>).</p>
<p>We demonstrate different methods to normalize the count data from lymphoblastoid cell lines from 69 unrelated Nigerian individuals, described in <a href="https://pubmed.ncbi.nlm.nih.gov/20220758/">Pickrell, et al. 2010</a>. This data are available through the Bioconductor’s <code>tweeDEseqCountData</code> package.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="rnaseq-data-analysis.html#cb1-1"></a><span class="kw">library</span>(tweeDEseqCountData)</span></code></pre></div>
<pre><code>## Loading required package: Biobase</code></pre>
<pre><code>## Loading required package: BiocGenerics</code></pre>
<pre><code>## Loading required package: parallel</code></pre>
<pre><code>## 
## Attaching package: &#39;BiocGenerics&#39;</code></pre>
<pre><code>## The following objects are masked from &#39;package:parallel&#39;:
## 
##     clusterApply, clusterApplyLB, clusterCall, clusterEvalQ,
##     clusterExport, clusterMap, parApply, parCapply, parLapply,
##     parLapplyLB, parRapply, parSapply, parSapplyLB</code></pre>
<pre><code>## The following objects are masked from &#39;package:stats&#39;:
## 
##     IQR, mad, sd, var, xtabs</code></pre>
<pre><code>## The following objects are masked from &#39;package:base&#39;:
## 
##     anyDuplicated, append, as.data.frame, basename, cbind, colnames,
##     dirname, do.call, duplicated, eval, evalq, Filter, Find, get, grep,
##     grepl, intersect, is.unsorted, lapply, Map, mapply, match, mget,
##     order, paste, pmax, pmax.int, pmin, pmin.int, Position, rank,
##     rbind, Reduce, rownames, sapply, setdiff, sort, table, tapply,
##     union, unique, unsplit, which, which.max, which.min</code></pre>
<pre><code>## Welcome to Bioconductor
## 
##     Vignettes contain introductory material; view with
##     &#39;browseVignettes()&#39;. To cite Bioconductor, see
##     &#39;citation(&quot;Biobase&quot;)&#39;, and for packages &#39;citation(&quot;pkgname&quot;)&#39;.</code></pre>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="rnaseq-data-analysis.html#cb10-1"></a><span class="kw">data</span>(pickrell)</span>
<span id="cb10-2"><a href="rnaseq-data-analysis.html#cb10-2"></a>pickrell.eset</span></code></pre></div>
<pre><code>## ExpressionSet (storageMode: lockedEnvironment)
## assayData: 52580 features, 69 samples 
##   element names: exprs 
## protocolData: none
## phenoData
##   sampleNames: NA18486 NA18498 ... NA19257 (69 total)
##   varLabels: num.tech.reps population study gender
##   varMetadata: labelDescription
## featureData
##   featureNames: ENSG00000000003 ENSG00000000005 ... LRG_99 (52580
##     total)
##   fvarLabels: gene
##   fvarMetadata: labelDescription
## experimentData: use &#39;experimentData(object)&#39;
## Annotation:</code></pre>
<p>The object <code>pickrell.est</code> is an <code>ExpressionSet</code> containing RNA-seq count data obtained from the <strong>ReCount</strong> repository available at . Details on the pre-processing steps to obtain this table of counts from the raw reads are provided on the website and in <a href="https://pubmed.ncbi.nlm.nih.gov/22087737/">Frazee, et al. 2011</a>.</p>
<p>Our aim is to use this data to compare different normalization methods. The most simple normalization is to standardize the counts dividing them by the total number of reads in the sample (size of the libraries) and multiplying by <span class="math inline">\(10^6\)</span> (CPM):</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="rnaseq-data-analysis.html#cb12-1"></a>counts &lt;-<span class="st"> </span><span class="kw">exprs</span>(pickrell.eset)</span>
<span id="cb12-2"><a href="rnaseq-data-analysis.html#cb12-2"></a>lib.size &lt;-<span class="st"> </span><span class="kw">colSums</span>(counts)</span>
<span id="cb12-3"><a href="rnaseq-data-analysis.html#cb12-3"></a>NormByCPM &lt;-<span class="st"> </span><span class="kw">sweep</span>(counts, <span class="dv">2</span>, <span class="dt">FUN=</span><span class="st">&quot;/&quot;</span>, lib.size) <span class="op">*</span><span class="st"> </span><span class="dv">10</span><span class="op">^</span><span class="dv">6</span></span></code></pre></div>
<p>Check that the sum of each column after CPM normalization equals to <span class="math inline">\(10^6\)</span></p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="rnaseq-data-analysis.html#cb13-1"></a><span class="kw">colSums</span>(NormByCPM)</span></code></pre></div>
<pre><code>## NA18486 NA18498 NA18499 NA18501 NA18502 NA18504 NA18505 NA18507 NA18508 NA18510 
##   1e+06   1e+06   1e+06   1e+06   1e+06   1e+06   1e+06   1e+06   1e+06   1e+06 
## NA18511 NA18516 NA18517 NA18519 NA18520 NA18522 NA18523 NA18852 NA18853 NA18855 
##   1e+06   1e+06   1e+06   1e+06   1e+06   1e+06   1e+06   1e+06   1e+06   1e+06 
## NA18856 NA18858 NA18861 NA18862 NA18870 NA18871 NA18909 NA18912 NA18913 NA18916 
##   1e+06   1e+06   1e+06   1e+06   1e+06   1e+06   1e+06   1e+06   1e+06   1e+06 
## NA19093 NA19098 NA19099 NA19101 NA19102 NA19108 NA19114 NA19116 NA19119 NA19127 
##   1e+06   1e+06   1e+06   1e+06   1e+06   1e+06   1e+06   1e+06   1e+06   1e+06 
## NA19128 NA19130 NA19131 NA19137 NA19138 NA19140 NA19143 NA19144 NA19147 NA19152 
##   1e+06   1e+06   1e+06   1e+06   1e+06   1e+06   1e+06   1e+06   1e+06   1e+06 
## NA19153 NA19159 NA19160 NA19171 NA19172 NA19190 NA19192 NA19193 NA19200 NA19201 
##   1e+06   1e+06   1e+06   1e+06   1e+06   1e+06   1e+06   1e+06   1e+06   1e+06 
## NA19203 NA19204 NA19209 NA19210 NA19222 NA19225 NA19238 NA19239 NA19257 
##   1e+06   1e+06   1e+06   1e+06   1e+06   1e+06   1e+06   1e+06   1e+06</code></pre>
<p>For an RPKM (reads per kilobase of transcript and million mapped reads) normalization, we first need to know the length of query regions (e.g. length of genes). This information is also available from the <code>tweeDEseqCountData</code> package, but can also be obtained from <code>biomaRt</code>.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="rnaseq-data-analysis.html#cb15-1"></a><span class="kw">data</span>(annotEnsembl63)</span>
<span id="cb15-2"><a href="rnaseq-data-analysis.html#cb15-2"></a><span class="kw">head</span>(annotEnsembl63)</span></code></pre></div>
<pre><code>##                 Symbol Chr     Start       End EntrezID
## ENSG00000252775     U7   5 133913821 133913880     &lt;NA&gt;
## ENSG00000207459     U6   5 133970529 133970635     &lt;NA&gt;
## ENSG00000252899     U7   5 133997420 133997479     &lt;NA&gt;
## ENSG00000201298     U6   5 134036862 134036968     &lt;NA&gt;
## ENSG00000222266     U6   5 134051173 134051272     &lt;NA&gt;
## ENSG00000222924     U6   5 137405044 137405147     &lt;NA&gt;
##                                                     Description Length
## ENSG00000252775 U7 small nuclear RNA  [Source:RFAM;Acc:RF00066]     NA
## ENSG00000207459  U6 spliceosomal RNA  [Source:RFAM;Acc:RF00026]     NA
## ENSG00000252899 U7 small nuclear RNA  [Source:RFAM;Acc:RF00066]     NA
## ENSG00000201298  U6 spliceosomal RNA  [Source:RFAM;Acc:RF00026]     NA
## ENSG00000222266  U6 spliceosomal RNA  [Source:RFAM;Acc:RF00026]     NA
## ENSG00000222924  U6 spliceosomal RNA  [Source:RFAM;Acc:RF00026]     NA
##                 GCcontent
## ENSG00000252775        NA
## ENSG00000207459        NA
## ENSG00000252899        NA
## ENSG00000201298        NA
## ENSG00000222266        NA
## ENSG00000222924        NA</code></pre>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="rnaseq-data-analysis.html#cb17-1"></a>genes.ok &lt;-<span class="st"> </span><span class="kw">intersect</span>(<span class="kw">as.character</span>(<span class="kw">rownames</span>(counts)), </span>
<span id="cb17-2"><a href="rnaseq-data-analysis.html#cb17-2"></a>                      <span class="kw">as.character</span>(<span class="kw">rownames</span>(annotEnsembl63)))</span>
<span id="cb17-3"><a href="rnaseq-data-analysis.html#cb17-3"></a>geneAnnot &lt;-<span class="st"> </span>annotEnsembl63[genes.ok,]</span>
<span id="cb17-4"><a href="rnaseq-data-analysis.html#cb17-4"></a>counts.ok &lt;-<span class="st"> </span>counts[genes.ok,]</span>
<span id="cb17-5"><a href="rnaseq-data-analysis.html#cb17-5"></a><span class="kw">identical</span>(<span class="kw">rownames</span>(geneAnnot), <span class="kw">rownames</span>(counts.ok))</span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<p>We obtain annotation data in the object <code>annotEnsembl63</code> and map it to <code>counts</code>, we then check that both <code>data.frame</code> are in the same order. The RPKM normalization is computed by</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="rnaseq-data-analysis.html#cb19-1"></a>geneLengths &lt;-<span class="st"> </span>geneAnnot<span class="op">$</span>Length</span>
<span id="cb19-2"><a href="rnaseq-data-analysis.html#cb19-2"></a>NormByRPKM &lt;-<span class="st"> </span><span class="kw">t</span>(<span class="kw">t</span>(counts.ok <span class="op">/</span><span class="st"> </span>geneLengths <span class="op">*</span><span class="dv">10</span><span class="op">^</span><span class="dv">3</span>)</span>
<span id="cb19-3"><a href="rnaseq-data-analysis.html#cb19-3"></a>                   <span class="op">/</span><span class="kw">colSums</span>(counts.ok)<span class="op">*</span><span class="dv">10</span><span class="op">^</span><span class="dv">6</span>)</span></code></pre></div>
<p>Check that the sum of each column after RPKM normalization is not equal to <span class="math inline">\(10^6\)</span></p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="rnaseq-data-analysis.html#cb20-1"></a><span class="kw">colSums</span>(NormByRPKM, <span class="dt">na.rm=</span><span class="ot">TRUE</span>)</span></code></pre></div>
<pre><code>##  NA18486  NA18498  NA18499  NA18501  NA18502  NA18504  NA18505  NA18507 
## 446915.7 468875.1 451749.9 424849.8 465086.6 462163.4 461488.9 474510.7 
##  NA18508  NA18510  NA18511  NA18516  NA18517  NA18519  NA18520  NA18522 
## 461575.7 463082.1 469532.5 494144.4 453952.3 465812.3 475356.5 450742.2 
##  NA18523  NA18852  NA18853  NA18855  NA18856  NA18858  NA18861  NA18862 
## 465948.1 449445.6 541396.1 458492.5 446573.0 461737.2 419591.0 481777.5 
##  NA18870  NA18871  NA18909  NA18912  NA18913  NA18916  NA19093  NA19098 
## 464991.6 448378.9 487215.0 529199.2 471316.9 447690.0 436454.4 436349.0 
##  NA19099  NA19101  NA19102  NA19108  NA19114  NA19116  NA19119  NA19127 
## 428527.4 450986.4 539169.3 464412.9 552272.0 452169.8 488080.0 533040.2 
##  NA19128  NA19130  NA19131  NA19137  NA19138  NA19140  NA19143  NA19144 
## 565341.8 460997.0 459320.6 451752.3 425970.4 503160.3 462846.1 440995.7 
##  NA19147  NA19152  NA19153  NA19159  NA19160  NA19171  NA19172  NA19190 
## 512702.4 462656.1 443485.7 435608.1 483709.9 428850.3 459705.1 491931.6 
##  NA19192  NA19193  NA19200  NA19201  NA19203  NA19204  NA19209  NA19210 
## 465900.2 567158.2 439382.1 465267.3 512908.7 424076.6 468026.6 491900.9 
##  NA19222  NA19225  NA19238  NA19239  NA19257 
## 440928.6 510870.3 455355.5 439798.3 498785.3</code></pre>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="rnaseq-data-analysis.html#cb22-1"></a><span class="co">#find gene length normalized values</span></span>
<span id="cb22-2"><a href="rnaseq-data-analysis.html#cb22-2"></a>rpk &lt;-<span class="st"> </span><span class="kw">apply</span>(counts.ok, <span class="dv">2</span>, </span>
<span id="cb22-3"><a href="rnaseq-data-analysis.html#cb22-3"></a>              <span class="cf">function</span>(x) x<span class="op">/</span>(geneLengths<span class="op">/</span><span class="dv">10</span><span class="op">^</span><span class="dv">3</span>))</span>
<span id="cb22-4"><a href="rnaseq-data-analysis.html#cb22-4"></a><span class="co">#normalize by the sample size using rpk values</span></span>
<span id="cb22-5"><a href="rnaseq-data-analysis.html#cb22-5"></a>NormByTPM &lt;-<span class="st"> </span><span class="kw">apply</span>(rpk, <span class="dv">2</span>, </span>
<span id="cb22-6"><a href="rnaseq-data-analysis.html#cb22-6"></a>                   <span class="cf">function</span>(x) x <span class="op">/</span><span class="st"> </span><span class="kw">sum</span>(<span class="kw">as.numeric</span>(x), <span class="dt">na.rm=</span><span class="ot">TRUE</span>) <span class="op">*</span><span class="st"> </span><span class="dv">10</span><span class="op">^</span><span class="dv">6</span>)</span></code></pre></div>
<p>Check that the sum of each column after RPM normalization equals to <span class="math inline">\(10^6\)</span></p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="rnaseq-data-analysis.html#cb23-1"></a><span class="kw">colSums</span>(NormByTPM, <span class="dt">na.rm=</span><span class="ot">TRUE</span>)</span></code></pre></div>
<pre><code>## NA18486 NA18498 NA18499 NA18501 NA18502 NA18504 NA18505 NA18507 NA18508 NA18510 
##   1e+06   1e+06   1e+06   1e+06   1e+06   1e+06   1e+06   1e+06   1e+06   1e+06 
## NA18511 NA18516 NA18517 NA18519 NA18520 NA18522 NA18523 NA18852 NA18853 NA18855 
##   1e+06   1e+06   1e+06   1e+06   1e+06   1e+06   1e+06   1e+06   1e+06   1e+06 
## NA18856 NA18858 NA18861 NA18862 NA18870 NA18871 NA18909 NA18912 NA18913 NA18916 
##   1e+06   1e+06   1e+06   1e+06   1e+06   1e+06   1e+06   1e+06   1e+06   1e+06 
## NA19093 NA19098 NA19099 NA19101 NA19102 NA19108 NA19114 NA19116 NA19119 NA19127 
##   1e+06   1e+06   1e+06   1e+06   1e+06   1e+06   1e+06   1e+06   1e+06   1e+06 
## NA19128 NA19130 NA19131 NA19137 NA19138 NA19140 NA19143 NA19144 NA19147 NA19152 
##   1e+06   1e+06   1e+06   1e+06   1e+06   1e+06   1e+06   1e+06   1e+06   1e+06 
## NA19153 NA19159 NA19160 NA19171 NA19172 NA19190 NA19192 NA19193 NA19200 NA19201 
##   1e+06   1e+06   1e+06   1e+06   1e+06   1e+06   1e+06   1e+06   1e+06   1e+06 
## NA19203 NA19204 NA19209 NA19210 NA19222 NA19225 NA19238 NA19239 NA19257 
##   1e+06   1e+06   1e+06   1e+06   1e+06   1e+06   1e+06   1e+06   1e+06</code></pre>
<p>None of these metrics (CPM, RPKM/FPKM, TPM) account for the other important confounding factor when comparing expression levels of genes across samples: the <strong>library composition</strong>, which may also be referred to as the <strong>relative size of the compared transcriptomes</strong>. This factor is not dependent on the sequencing technology, it is rather biological. For instance, when comparing transcriptomes of different tissues, there can be sets of genes in one tissue that consume a big chunk of the reads, while in the other tissues they are not expressed at all. This kind of imbalance in the composition of compared transcriptomes can lead to wrong conclusions about which genes are actually differentially expressed. This consideration is addressed in two popular R packages: <code>DESeq2</code> (<a href="https://genomebiology.biomedcentral.com/articles/10.1186/s13059-014-0550-8">Love, Huber, and Anders 2014</a>) and <code>edgeR</code> (<a href="https://pubmed.ncbi.nlm.nih.gov/19910308/">Robinson, McCarthy, and Smyth 2010</a>) each with a different algorithm. <code>edgeR</code> uses a normalization procedure called Trimmed Mean of M-values (TMM). <code>DESeq2</code> implements a normalization procedure using median of Ratios, which is obtained by finding the ratio of the log-transformed count of a gene divided by the average of log-transformed values of the gene in all samples (geometric mean), and then taking the median of these values for all genes. The raw read count of the gene is finally divided by this value (median of ratios) to obtain the normalized counts.</p>
<p>The <code>DESeq2</code> normalization is automatically performed when using <code>DESeq2</code> package (we will see it later). We now apply a TMM (trimmed mean of M-values) normalization which, as previously mentioned, was developed to correct the gene counts by the expression properties of the whole sample. The TMM normalization method is implemented in the Bioconductor’s <code>tweeDEseq</code> package and can be performed by:</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="rnaseq-data-analysis.html#cb25-1"></a><span class="kw">library</span>(tweeDEseq)</span>
<span id="cb25-2"><a href="rnaseq-data-analysis.html#cb25-2"></a>NormByTMM &lt;-<span class="st"> </span><span class="kw">normalizeCounts</span>(counts.ok, <span class="dt">method=</span><span class="st">&quot;TMM&quot;</span>)</span></code></pre></div>
<pre><code>## Using edgeR-TMM normalization.</code></pre>
<pre><code>## Calculating normalization factors with the TMM method.</code></pre>
<pre><code>## Estimating common dispersion.</code></pre>
<pre><code>## Estimating tagwise dispersions.</code></pre>
<pre><code>## Calculating effective library sizes.</code></pre>
<pre><code>## Adjusting counts to effective library sizes using tagwise dispersions.</code></pre>
<p>Another type of normalization is CQN, available in the package <code>cqn</code>. It requires different steps that have been encapsulated in the function called <code>normalizeCounts ()</code> from <code>tweeDEseq</code>. The function requires the length and the percentage of GC-content of each gene.</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="rnaseq-data-analysis.html#cb32-1"></a><span class="kw">library</span>(cqn)       </span></code></pre></div>
<pre><code>## Loading required package: mclust</code></pre>
<pre><code>## Package &#39;mclust&#39; version 5.4.6
## Type &#39;citation(&quot;mclust&quot;)&#39; for citing this R package in publications.</code></pre>
<pre><code>## Loading required package: nor1mix</code></pre>
<pre><code>## Loading required package: preprocessCore</code></pre>
<pre><code>## Loading required package: splines</code></pre>
<pre><code>## Loading required package: quantreg</code></pre>
<pre><code>## Warning: package &#39;quantreg&#39; was built under R version 4.0.3</code></pre>
<pre><code>## Loading required package: SparseM</code></pre>
<pre><code>## 
## Attaching package: &#39;SparseM&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:base&#39;:
## 
##     backsolve</code></pre>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="rnaseq-data-analysis.html#cb43-1"></a>annotation &lt;-<span class="st"> </span>geneAnnot[,<span class="kw">c</span>(<span class="st">&quot;Length&quot;</span>, <span class="st">&quot;GCcontent&quot;</span>)]</span>
<span id="cb43-2"><a href="rnaseq-data-analysis.html#cb43-2"></a>NormByCQN &lt;-<span class="st"> </span><span class="kw">normalizeCounts</span>(counts.ok, <span class="dt">method=</span><span class="st">&quot;cqn&quot;</span>,</span>
<span id="cb43-3"><a href="rnaseq-data-analysis.html#cb43-3"></a>                             <span class="dt">annot=</span>annotation)</span></code></pre></div>
<pre><code>## Using cqn normalization.</code></pre>
<pre><code>## RQ fit .....................................................................
## SQN</code></pre>
<pre><code>## Warning: The use of &#39;sig2&#39; is deprecated; do specify &#39;sigma&#39; (= sqrt(sig2))
## instead</code></pre>
<pre><code>## .</code></pre>
<p>We now compare the performance of each normalization method. Assuming that between two samples, most genes are not differentially expressed, the distribution of the difference of log-ratios between the samples should be centered around 0 when data is correctly normalized. We thus examine the distributions for the 1st and 2nd sample under normalization by the total number of reads and by RPKM (Figure (fig:checkNorm):</p>
<div class="figure" style="text-align: center"><span id="fig:checkNorm"></span>
<img src="_main_files/figure-html/checkNorm-1.png" alt="Comparison of log-ratio count intensity of samples 1 and 2 from the Pickrell dataset." width="672" />
<p class="caption">
Figure 6.5: Comparison of log-ratio count intensity of samples 1 and 2 from the Pickrell dataset.
</p>
</div>
<p>Figure <a href="rnaseq-data-analysis.html#fig:checkNorm">6.5</a>, however, does not show whether the null difference between samples holds for different levels of gene expression. With a MA-plot, one can check whether data has been correctly normalized at any expression level. The MA-plot is available from the Bioconductor package <code>edgeR</code>. The resulting plot can be seen in Figure <a href="#fig:MAall"><strong>??</strong></a> (top left part). In the X-axis the plot shows the mean between the log-ratios. In the Y-axis the plot shows the difference of log-ratios between the samples, similar to figure <a href="rnaseq-data-analysis.html#fig:checkNorm">6.5</a>. The MA-plot is, therefore, the difference against the mean of the gene counts between the two samples. The red line shows the expected M-values as a function of A-values. In our example of non-normalized data, we can see that for genes with low counts the distribution of the difference between samples is not zero; in particular, we observe that sample 2 has more counts than sample 1.</p>
</div>
<div id="exploratory-analysis-of-the-read-counts-table" class="section level2" number="6.3">
<h2><span class="header-section-number">6.3</span> Exploratory analysis of the read counts table</h2>
<p>A typical quality control, in this case interrogating the RNA-seq experiment design, is to measure the similarity of the samples with each other in terms of the quantified expression level profiles across a set of genes. One important observation to make is to see whether the most similar samples to any given sample are the biological replicates of that sample. This can be computed using unsupervised clustering techniques such as hierarchical clustering and visualized as a heatmap with dendrograms. Another most commonly applied technique is a dimensionality reduction technique called Principal Component Analysis (PCA) and visualized as a two-dimensional (or in some cases three-dimensional) scatter plot.</p>
<div id="clustering" class="section level3" number="6.3.1">
<h3><span class="header-section-number">6.3.1</span> Clustering</h3>
<p>We can combine clustering and visualization of the clustering results by using heatmap functions that are available in a variety of R libraries. The basic R installation comes with the <code>stats::heatmap ()</code> function. However, there are other libraries available in CRAN (e.g. <code>pheatmap</code>) or Bioconductor (e.g. <code>ComplexHeatmap</code>) that come with more flexibility and more appealing visualizations.</p>
<p>Here we demonstrate a heatmap using the <code>pheatmap</code> package and the previously calculated <code>NormByTPM</code> matrix. As these matrices can be quite large, both computing the clustering and rendering the heatmaps can take a lot of resources and time. Therefore, a quick and informative way to compare samples is to select a subset of genes that are, for instance, most variable across samples, and use that subset to do the clustering and visualization.</p>
<p>Let’s select the top 100 most variable genes among the samples.</p>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="rnaseq-data-analysis.html#cb48-1"></a><span class="co">#compute the variance of each gene across samples</span></span>
<span id="cb48-2"><a href="rnaseq-data-analysis.html#cb48-2"></a>V &lt;-<span class="st"> </span><span class="kw">apply</span>(NormByTPM, <span class="dv">1</span>, var)</span>
<span id="cb48-3"><a href="rnaseq-data-analysis.html#cb48-3"></a><span class="co">#sort the results by variance in decreasing order </span></span>
<span id="cb48-4"><a href="rnaseq-data-analysis.html#cb48-4"></a><span class="co">#and select the top 100 genes </span></span>
<span id="cb48-5"><a href="rnaseq-data-analysis.html#cb48-5"></a>selectedGenes &lt;-<span class="st"> </span><span class="kw">names</span>(V[<span class="kw">order</span>(V, <span class="dt">decreasing =</span> T)][<span class="dv">1</span><span class="op">:</span><span class="dv">100</span>])</span></code></pre></div>
<p>Now we can quickly produce a heatmap where samples and genes are clustered (see Figure @ref{fig:clust}).</p>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="rnaseq-data-analysis.html#cb49-1"></a><span class="kw">library</span>(pheatmap)</span></code></pre></div>
<pre><code>## Warning: package &#39;pheatmap&#39; was built under R version 4.0.3</code></pre>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="rnaseq-data-analysis.html#cb51-1"></a><span class="kw">pheatmap</span>(NormByTPM[selectedGenes,], <span class="dt">scale =</span> <span class="st">&#39;row&#39;</span>, <span class="dt">show_rownames =</span> <span class="ot">FALSE</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/clust-1.png" width="672" style="display: block; margin: auto;" /></p>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="microarray-data-analysis.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="references.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/isglobal-brge/Master_Bioinformatics/tree/master/docs04-RNAseq_data_analysis.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["_main.pdf", "_main.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
